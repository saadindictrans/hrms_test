var b=(_,c,u)=>new Promise((h,n)=>{var s=r=>{try{f(u.next(r))}catch(l){n(l)}},m=r=>{try{f(u.throw(r))}catch(l){n(l)}},f=r=>r.done?h(r.value):Promise.resolve(r.value).then(s,m);f((u=u.apply(_,c)).next())});import{G as j,j as p,k as w,H as R,a as y,Q as V,O as I,A as L,n as d,v as o,i as U,l as i,q as a,t as g,a8 as k,Z as x,a9 as D,Y as P,y as E,F,I as N,a5 as B,z as C}from"./frappe-ui-qLvTFYQB.js";import{I as $,a as S}from"./index-CEKosOWR.js";const H={},M={xmlns:"http://www.w3.org/2000/svg",width:"200",height:"100",viewBox:"0 0 200 100"};function O(_,c){return p(),w("svg",M,c[0]||(c[0]=[R('<rect x="10" y="20" width="180" height="60" fill="#FFD700" stroke="#000" stroke-width="2" rx="10"></rect><rect x="20" y="30" width="40" height="30" fill="#87CEEB"></rect><rect x="70" y="30" width="40" height="30" fill="#87CEEB"></rect><rect x="120" y="30" width="40" height="30" fill="#87CEEB"></rect><circle cx="50" cy="80" r="10" fill="#333"></circle><circle cx="150" cy="80" r="10" fill="#333"></circle><rect x="160" y="30" width="20" height="30" fill="#FFF" stroke="#000" stroke-width="1"></rect>',7)]))}const T=j(H,[["render",O]]),G={class:"flex h-screen w-screen flex-col justify-center bg-white"},Y={class:"flex flex-col mx-auto gap-3 items-center"},q={class:"text-3xl font-semibold text-gray-900 text-center"},z={class:"mx-auto mt-10 w-full px-8 sm:w-96"},A={class:"space-y-4"},Q=["href"],Z=["src","alt"],J={class:"text-lg font-bold"},K=["href"],W={key:0,class:"mb-4"},oe={__name:"Login",setup(_){const c=y(null),u=y(null),h=y(""),n=V({showDialog:!1,link:""}),s=V({showDialog:!1,tmp_id:"",code:"",verification:{}}),m=U("$session");function f(l){return b(this,null,function*(){try{let e;s.showDialog?e=yield m.otp(s.tmp_id,s.code):e=yield m.login(c.value,u.value),e.message==="Password Reset"?(n.showDialog=!0,n.link=e.redirect_to):(n.showDialog=!1,n.link=""),e.verification&&(e.verification.setup?(s.showDialog=!0,s.tmp_id=e.tmp_id,s.verification=e.verification):window.open("/login?redirect-to="+encodeURIComponent(window.location.pathname),"_blank"))}catch(e){h.value=e.messages.join(`
`)}})}const r=I({url:"hrms.api.oauth.oauth_providers",auto:!0});return(l,e)=>(p(),L(o(S),null,{default:d(()=>[i(o($),{class:"ion-padding"},{default:d(()=>{var v;return[a("div",G,[a("div",Y,[i(T,{class:"h-8 w-8"}),a("div",q,g(l.__("Login to Frappe HR")),1)]),a("div",z,[a("form",{class:"flex flex-col space-y-4",onSubmit:k(f,["prevent"])},[i(o(x),{label:l.__("Email"),placeholder:"johndoe@mail.com",modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=t=>c.value=t),type:"text",autocomplete:"username"},null,8,["label","modelValue"]),i(o(x),{label:l.__("Password"),type:"password",placeholder:"••••••",modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=t=>u.value=t),autocomplete:"current-password"},null,8,["label","modelValue"]),i(o(D),{message:h.value},null,8,["message"]),i(o(P),{loading:o(m).login.loading,variant:"solid",class:"disabled:bg-gray-700 disabled:text-white !mt-6"},{default:d(()=>[E(g(l.__("Login")),1)]),_:1},8,["loading"])],32),(v=o(r).data)!=null&&v.length?(p(),w(F,{key:0},[e[5]||(e[5]=a("div",{class:"text-center text-sm text-gray-600 my-4"},"or",-1)),a("div",A,[(p(!0),w(F,null,N(o(r).data,t=>(p(),w("a",{key:t.name,class:"flex items-center justify-center gap-2 transition-colors focus:outline-none text-gray-800 bg-gray-100 hover:bg-gray-200 active:bg-gray-300 focus-visible:ring focus-visible:ring-gray-400 h-7 text-base p-2 rounded",href:t.auth_url},[a("img",{class:"h-4 w-4",src:t.icon,alt:t.provider_name},null,8,Z),a("span",null,"Login with "+g(t.provider_name),1)],8,Q))),128))])],64)):B("",!0)])]),i(o(C),{modelValue:n.showDialog,"onUpdate:modelValue":e[2]||(e[2]=t=>n.showDialog=t)},{"body-title":d(()=>[a("h2",J,g(l.__("Reset Password")),1)]),"body-content":d(()=>[a("p",null,g(l.__("Your password has expired. Please reset your password to continue")),1)]),actions:d(()=>[a("a",{class:"inline-flex items-center justify-center gap-2 transition-colors focus:outline-none text-white bg-gray-900 hover:bg-gray-800 active:bg-gray-700 focus-visible:ring focus-visible:ring-gray-400 h-7 text-base px-2 rounded",href:n.link,target:"_blank"},g(l.__("Go to Reset Password page")),9,K)]),_:1},8,["modelValue"]),i(o(C),{modelValue:s.showDialog,"onUpdate:modelValue":e[4]||(e[4]=t=>s.showDialog=t)},{"body-title":d(()=>e[6]||(e[6]=[a("h2",{class:"text-lg font-bold"},"OTP Verification",-1)])),"body-content":d(()=>[s.verification.prompt?(p(),w("p",W,g(s.verification.prompt),1)):B("",!0),a("form",{class:"flex flex-col space-y-4",onSubmit:k(f,["prevent"])},[i(o(x),{label:"OTP Code",type:"text",placeholder:"000000",modelValue:s.code,"onUpdate:modelValue":e[3]||(e[3]=t=>s.code=t),autocomplete:"one-time-code"},null,8,["modelValue"]),i(o(D),{message:h.value},null,8,["message"]),i(o(P),{loading:o(m).otp.loading,variant:"solid",class:"disabled:bg-gray-700 disabled:text-white !mt-6"},{default:d(()=>e[7]||(e[7]=[E(" Verify ")])),_:1},8,["loading"])],32)]),_:1},8,["modelValue"])]}),_:1})]),_:1}))}};export{oe as default};
//# sourceMappingURL=Login-Bi4EOj-I.js.map
