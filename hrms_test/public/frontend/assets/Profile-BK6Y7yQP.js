var x=(v,d,_)=>new Promise((p,r)=>{var l=n=>{try{g(_.next(n))}catch(i){r(i)}},C=n=>{try{g(_.throw(n))}catch(i){r(i)}},g=n=>n.done?p(n.value):Promise.resolve(n.value).then(l,C);g((_=_.apply(v,d)).next())});import{a as P,c as q,aa as z,O as K,e as U,a4 as Y,A as G,n as m,v as e,i as b,ab as H,f as M,j as f,l as a,q as o,x as y,t as u,k as h,a5 as I,I as J,F as Q,y as W}from"./frappe-ui-qLvTFYQB.js";import{b as X,c as Z,I as ee,a as te}from"./index-CEKosOWR.js";import{f as oe}from"./formatters-Ct4yxM4M.js";import se from"./ProfileInfoModal-ZW06W5jU.js";import{a as ae}from"./notifications-W5tSfcNs.js";import"./FormattedField-xd4ggFYl.js";import"./EmployeeAvatar-C8o_82kt.js";const ne=v=>x(void 0,null,function*(){yield(yield X.create({header:"Error",message:v,buttons:["OK"]})).present()}),le={class:"flex flex-col h-screen w-screen"},re={class:"w-full sm:w-96"},ce={class:"flex flex-row bg-white shadow-sm py-4 px-3 items-center justify-between border-b sticky top-0 z-10"},ie={class:"flex flex-row items-center"},de={class:"text-xl font-semibold text-gray-900"},me={class:"flex flex-col items-center mt-5 p-4"},fe=["src","alt"],ue={key:1,class:"flex items-center justify-center bg-gray-200 uppercase text-gray-600 h-24 w-24 rounded-full object-cover"},_e={class:"flex flex-col gap-1.5 items-center mt-2 mb-5"},pe={key:0,class:"text-lg font-bold text-gray-900"},ye={key:1,class:"font-normal text-sm text-gray-500"},he={class:"flex flex-col gap-5 my-4 w-full"},ge={class:"flex flex-col bg-white rounded"},xe=["onClick"],be={class:"flex flex-row items-center gap-3 grow"},we={class:"text-base font-normal text-gray-800"},ve={key:2,class:"flex flex-col gap-5 my-4 w-full"},ke={class:"flex flex-col bg-white rounded"},Ce={class:"flex flex-row items-center gap-3 grow"},Ie={class:"text-base font-normal text-gray-800"},w="Employee",Oe={__name:"Profile",setup(v){const d=b("$socket"),_=b("$session"),p=b("$user"),r=b("$employee"),l=b("$translate"),C=H(),g=[{icon:"user",title:l("Employee Details"),fields:["employee_name","employee_number","gender","date_of_birth","date_of_joining","blood_group"]},{icon:"file",title:l("Company Information"),fields:["company","department","designation","branch","grade","reports_to","employment_type"]},{icon:"book",title:l("Contact Information"),fields:["cell_number","personal_email","company_email","preferred_email"]},{icon:"dollar-sign",title:l("Salary Information"),fields:["ctc","payroll_cost_center","pan_number","provident_fund_account","salary_mode","bank_name","bank_ac_no","ifsc_code","micr_code","iban"]}],n=P(!1),i=P(null),O=q(()=>{var t;return((t=window.frappe)==null?void 0:t.boot.push_relay_server_url)&&ae.data}),S=t=>x(this,null,function*(){i.value=t,n.value=!0}),V=t=>x(this,null,function*(){n.value=!1,i.value=null}),j=z({doctype:w,name:r.data.name,fields:"*",auto:!0,transform:t=>(t.ctc=oe(t.ctc,t.salary_currency),t)}),A=K({url:"hrms.api.get_doctype_fields",params:{doctype:w},auto:!0}),F=t=>{const s=A.data.find(k=>k.fieldname===t);return[l(s==null?void 0:s.label,null,"Employee"),s==null?void 0:s.fieldtype]},L=()=>x(this,null,function*(){try{yield _.logout.submit()}catch(t){const s="An error occurred while attempting to log out!";console.error(s,t),ne(s)}});return U(()=>{d.emit("doctype_subscribe",w),d.on("list_update",t=>{t.doctype===w&&t.name===r.data.name&&j.reload()})}),Y(()=>{d.emit("doctype_unsubscribe",w),d.off("list_update")}),(t,s)=>{const k=M("Button"),R=M("router-link");return f(),G(e(te),null,{default:m(()=>[a(e(ee),{class:"ion-padding"},{default:m(()=>{var $,D,E,B;return[o("div",le,[o("div",re,[o("header",ce,[o("div",ie,[a(k,{variant:"ghost",class:"!pl-0 hover:bg-white",onClick:s[0]||(s[0]=c=>e(C).back())},{default:m(()=>[a(e(y),{name:"chevron-left",class:"h-5 w-5"})]),_:1}),o("h2",de,u(e(l)("Profile")),1)])]),o("div",me,[e(p).data.user_image?(f(),h("img",{key:0,class:"h-24 w-24 rounded-full object-cover",src:e(p).data.user_image,alt:e(p).data.first_name},null,8,fe)):(f(),h("div",ue,u(e(p).data.first_name[0]),1)),o("div",_e,[e(r)?(f(),h("span",pe,u((D=($=e(r))==null?void 0:$.data)==null?void 0:D.employee_name),1)):I("",!0),e(r)?(f(),h("span",ye,u((B=(E=e(r))==null?void 0:E.data)==null?void 0:B.designation),1)):I("",!0)]),o("div",he,[o("div",ge,[(f(),h(Q,null,J(g,c=>o("div",{class:"flex flex-row cursor-pointer flex-start p-4 items-center justify-between border-b",key:c.title,onClick:N=>S(c)},[o("div",be,[a(e(y),{name:c.icon,class:"h-5 w-5 text-gray-500"},null,8,["name"]),o("div",we,u(c.title),1)]),a(e(y),{name:"chevron-right",class:"h-5 w-5 text-gray-500"})],8,xe)),64))])]),O.value?(f(),h("div",ve,[o("div",ke,[a(R,{to:{name:"Settings"},class:"flex flex-row cursor-pointer flex-start p-4 items-center justify-between border-b"},{default:m(()=>[o("div",Ce,[a(e(y),{name:"settings",class:"h-5 w-5 text-gray-500"}),o("div",Ie,u(e(l)("Settings")),1)]),a(e(y),{name:"chevron-right",class:"h-5 w-5 text-gray-500"})]),_:1})])])):I("",!0),a(k,{onClick:L,variant:"outline",theme:"red",class:"w-full shadow py-4 mt-5"},{prefix:m(()=>[a(e(y),{name:"log-out",class:"w-4"})]),default:m(()=>[W(" "+u(e(l)("Log Out")),1)]),_:1})])])]),a(e(Z),{ref:"modal","is-open":n.value,onDidDismiss:V,"initial-breakpoint":1,breakpoints:[0,1]},{default:m(()=>[a(se,{title:i.value.title,data:i.value.fields.map(c=>{const[N,T]=F(c);return{fieldname:c,value:e(j).doc[c],label:N,fieldtype:T}})},null,8,["title","data"])]),_:1},8,["is-open"])]}),_:1})]),_:1})}}};export{Oe as default};
//# sourceMappingURL=Profile-BK6Y7yQP.js.map
