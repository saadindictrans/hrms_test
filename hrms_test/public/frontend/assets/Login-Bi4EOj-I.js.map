{"version":3,"file":"Login-Bi4EOj-I.js","sources":["../../../../frontend/src/components/icons/FrappeHRLogo.vue","../../../../frontend/src/views/Login.vue"],"sourcesContent":["<template>\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"200\" height=\"100\" viewBox=\"0 0 200 100\">\n        <!-- Bus Body -->\n        <rect x=\"10\" y=\"20\" width=\"180\" height=\"60\" fill=\"#FFD700\" stroke=\"#000\" stroke-width=\"2\" rx=\"10\" />\n\n        <!-- Windows -->\n        <rect x=\"20\" y=\"30\" width=\"40\" height=\"30\" fill=\"#87CEEB\" />\n        <rect x=\"70\" y=\"30\" width=\"40\" height=\"30\" fill=\"#87CEEB\" />\n        <rect x=\"120\" y=\"30\" width=\"40\" height=\"30\" fill=\"#87CEEB\" />\n\n        <!-- Wheels -->\n        <circle cx=\"50\" cy=\"80\" r=\"10\" fill=\"#333\" />\n        <circle cx=\"150\" cy=\"80\" r=\"10\" fill=\"#333\" />\n\n        <!-- Door -->\n        <rect x=\"160\" y=\"30\" width=\"20\" height=\"30\" fill=\"#FFF\" stroke=\"#000\" stroke-width=\"1\" />\n    </svg>\n</template>\n","<template>\n\t<ion-page>\n\t\t<ion-content class=\"ion-padding\">\n\t\t\t<div class=\"flex h-screen w-screen flex-col justify-center bg-white\">\n\t\t\t\t<div class=\"flex flex-col mx-auto gap-3 items-center\">\n\t\t\t\t\t<FrappeHRLogo class=\"h-8 w-8\" />\n\t\t\t\t\t<div class=\"text-3xl font-semibold text-gray-900 text-center\">\n\t\t\t\t\t\t{{ __(\"Login to Frappe HR\") }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"mx-auto mt-10 w-full px-8 sm:w-96\">\n\t\t\t\t\t<form class=\"flex flex-col space-y-4\" @submit.prevent=\"submit\">\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t:label=\"__('Email')\"\n\t\t\t\t\t\t\tplaceholder=\"johndoe@mail.com\"\n\t\t\t\t\t\t\tv-model=\"email\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tautocomplete=\"username\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t:label=\"__('Password')\"\n\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\tplaceholder=\"••••••\"\n\t\t\t\t\t\t\tv-model=\"password\"\n\t\t\t\t\t\t\tautocomplete=\"current-password\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<ErrorMessage :message=\"errorMessage\" />\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t:loading=\"session.login.loading\"\n\t\t\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t\t\tclass=\"disabled:bg-gray-700 disabled:text-white !mt-6\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ __(\"Login\") }}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</form>\n\n\t\t\t\t\t<template v-if=\"authProviders.data?.length\">\n\t\t\t\t\t\t<div class=\"text-center text-sm text-gray-600 my-4\">or</div>\n\t\t\t\t\t\t<div class=\"space-y-4\">\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\tv-for=\"provider in authProviders.data\"\n\t\t\t\t\t\t\t\t:key=\"provider.name\"\n\t\t\t\t\t\t\t\tclass=\"flex items-center justify-center gap-2 transition-colors focus:outline-none text-gray-800 bg-gray-100 hover:bg-gray-200 active:bg-gray-300 focus-visible:ring focus-visible:ring-gray-400 h-7 text-base p-2 rounded\"\n\t\t\t\t\t\t\t\t:href=\"provider.auth_url\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<img class=\"h-4 w-4\" :src=\"provider.icon\" :alt=\"provider.provider_name\" />\n\t\t\t\t\t\t\t\t<span>Login with {{ provider.provider_name }}</span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<Dialog v-model=\"resetPassword.showDialog\">\n\t\t\t\t<template #body-title>\n\t\t\t\t\t<h2 class=\"text-lg font-bold\">{{ __(\"Reset Password\") }} </h2>\n\t\t\t\t</template>\n\t\t\t\t<template #body-content>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t{{ __(\"Your password has expired. Please reset your password to continue\") }}\n\t\t\t\t\t</p>\n\t\t\t\t</template>\n\t\t\t\t<template #actions>\n\t\t\t\t\t<a\n\t\t\t\t\t\tclass=\"inline-flex items-center justify-center gap-2 transition-colors focus:outline-none text-white bg-gray-900 hover:bg-gray-800 active:bg-gray-700 focus-visible:ring focus-visible:ring-gray-400 h-7 text-base px-2 rounded\"\n\t\t\t\t\t\t:href=\"resetPassword.link\"\n\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ __(\"Go to Reset Password page\") }}\n\t\t\t\t\t</a>\n\t\t\t\t</template>\n\t\t\t</Dialog>\n\n\t\t\t<Dialog v-model=\"otp.showDialog\">\n\t\t\t\t<template #body-title>\n\t\t\t\t\t<h2 class=\"text-lg font-bold\">OTP Verification</h2>\n\t\t\t\t</template>\n\t\t\t\t<template #body-content>\n\t\t\t\t\t<p class=\"mb-4\" v-if=\"otp.verification.prompt\">\n\t\t\t\t\t\t{{ otp.verification.prompt }}\n\t\t\t\t\t</p>\n\n\t\t\t\t\t<form class=\"flex flex-col space-y-4\" @submit.prevent=\"submit\">\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tlabel=\"OTP Code\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tplaceholder=\"000000\"\n\t\t\t\t\t\t\tv-model=\"otp.code\"\n\t\t\t\t\t\t\tautocomplete=\"one-time-code\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<ErrorMessage :message=\"errorMessage\" />\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t:loading=\"session.otp.loading\"\n\t\t\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t\t\tclass=\"disabled:bg-gray-700 disabled:text-white !mt-6\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tVerify\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</form>\n\t\t\t\t</template>\n\t\t\t</Dialog>\n\t\t</ion-content>\n\t</ion-page>\n</template>\n\n<script setup>\nimport { IonPage, IonContent } from \"@ionic/vue\"\nimport { inject, reactive, ref } from \"vue\"\nimport { Input, Button, ErrorMessage, Dialog, createResource } from \"frappe-ui\"\n\nimport FrappeHRLogo from \"@/components/icons/FrappeHRLogo.vue\"\n\nconst email = ref(null)\nconst password = ref(null)\nconst errorMessage = ref(\"\")\n\nconst resetPassword = reactive({\n\tshowDialog: false,\n\tlink: \"\",\n})\nconst otp = reactive({\n\tshowDialog: false,\n\ttmp_id: \"\",\n\tcode: \"\",\n\tverification: {},\n})\n\nconst session = inject(\"$session\")\n\nasync function submit(e) {\n\ttry {\n\t\tlet response\n\t\tif (otp.showDialog) {\n\t\t\tresponse = await session.otp(otp.tmp_id, otp.code)\n\t\t} else {\n\t\t\tresponse = await session.login(email.value, password.value)\n\t\t}\n\n\t\tif (response.message === \"Password Reset\") {\n\t\t\tresetPassword.showDialog = true\n\t\t\tresetPassword.link = response.redirect_to\n\t\t} else {\n\t\t\tresetPassword.showDialog = false\n\t\t\tresetPassword.link = \"\"\n\t\t}\n\n\t\t// OTP verification\n\t\tif (response.verification) {\n\t\t\tif (response.verification.setup) {\n\t\t\t\totp.showDialog = true\n\t\t\t\totp.tmp_id = response.tmp_id\n\t\t\t\totp.verification = response.verification\n\t\t\t} else {\n\t\t\t\t// Don't bother handling impossible OTP setup (e.g. no phone number).\n\t\t\t\twindow.open(\"/login?redirect-to=\" + encodeURIComponent(window.location.pathname), \"_blank\")\n\t\t\t}\n\t\t}\n\t} catch (error) {\n\t\terrorMessage.value = error.messages.join(\"\\n\")\n\t}\n}\n\nconst authProviders = createResource({\n\turl: \"hrms.api.oauth.oauth_providers\",\n\tauto: true,\n})\n</script>\n"],"names":["_hoisted_1","_sfc_render","_ctx","_cache","_openBlock","_createElementBlock","email","ref","password","errorMessage","resetPassword","reactive","otp","session","inject","submit","e","__async","response","error","authProviders","createResource"],"mappings":"2cACSA,EAAkC,CAAC,MAAM,6BAAM,YAAa,oCAAjE,SAAAC,EAAAC,EAAAC,EAAA,CADJ,OAAAC,EAAA,EAAAC,EAAA,MAAAL,EAAAG,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,64BCiHA,MAAMG,EAAQC,EAAI,IAAI,EAChBC,EAAWD,EAAI,IAAI,EACnBE,EAAeF,EAAI,EAAE,EAErBG,EAAgBC,EAAS,CAC9B,WAAY,GACZ,KAAM,EACP,CAAC,EACKC,EAAMD,EAAS,CACpB,WAAY,GACZ,OAAQ,GACR,KAAM,GACN,aAAc,CAAE,CACjB,CAAC,EAEKE,EAAUC,EAAO,UAAU,EAEjC,SAAeC,EAAOC,EAAG,QAAAC,EAAA,sBACxB,GAAI,CACH,IAAIC,EACAN,EAAI,WACPM,EAAW,MAAML,EAAQ,IAAID,EAAI,OAAQA,EAAI,IAAI,EAEjDM,EAAW,MAAML,EAAQ,MAAMP,EAAM,MAAOE,EAAS,KAAK,EAGvDU,EAAS,UAAY,kBACxBR,EAAc,WAAa,GAC3BA,EAAc,KAAOQ,EAAS,cAE9BR,EAAc,WAAa,GAC3BA,EAAc,KAAO,IAIlBQ,EAAS,eACRA,EAAS,aAAa,OACzBN,EAAI,WAAa,GACjBA,EAAI,OAASM,EAAS,OACtBN,EAAI,aAAeM,EAAS,cAG5B,OAAO,KAAK,sBAAwB,mBAAmB,OAAO,SAAS,QAAQ,EAAG,QAAQ,EAG5F,OAAQC,EAAO,CACfV,EAAa,MAAQU,EAAM,SAAS,KAAK;AAAA,CAAI,CAC/C,CACA,GAEA,MAAMC,EAAgBC,EAAe,CACpC,IAAK,iCACL,KAAM,EACP,CAAC"}