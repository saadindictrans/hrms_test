import{I as g,a as q}from"./index-CEKosOWR.js";import{i as F,a as R,O as u,w as d,j as f,A as p,n as c,l as S,v as i,a5 as V}from"./frappe-ui-qLvTFYQB.js";import b from"./FormView-BRqGWGvk.js";import"./FormField-BCSqEHey.js";import"./Link-QcSLzh7C.js";import"./FileUploaderView-6mxw9ReX.js";import"./workflow-DLGjdWDd.js";import"./formatters-Ct4yxM4M.js";const B={__name:"ShiftRequestForm",props:{id:{type:String,required:!1}},setup(_){const s=F("$employee"),l=_,o=R({}),n=u({url:"hrms.api.get_doctype_fields",params:{doctype:"Shift Request"},auto:!0,transform(e){return l.id?e:e.filter(a=>!["employee","employee_name","status","company"].includes(a.fieldname))}});u({url:"hrms.api.get_shift_request_approvers",params:{employee:s.data.name},auto:!l.id,onSuccess(e){var r,m;const a=(r=n.data)==null?void 0:r.find(t=>t.fieldname==="approver");a.documentList=e==null?void 0:e.map(t=>({label:t.full_name?`${t.name} : ${t.full_name}`:t.name,value:t.name})),o.value.approver=(m=e[0])==null?void 0:m.name}}),d(()=>o.value.employee,e=>{l.id&&e!==s.data.name&&y()}),d(()=>[o.value.from_date,o.value.to_date],([e,a])=>{v(e,a)});function y(){o.value.approver!==s.data.user_id&&n.data.map(e=>e.read_only=!0)}function v(e,a){if(!(e&&a))return;const r=e>a?__("To Date cannot be before From Date"):"",m=n.data.find(t=>t.fieldname==="from_date");m.error_message=r}function h(){o.value.employee=s.data.name}return(e,a)=>(f(),p(i(q),null,{default:c(()=>[S(i(g),{fullscreen:!0},{default:c(()=>[i(n).data?(f(),p(b,{key:0,doctype:"Shift Request",modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=r=>o.value=r),isSubmittable:!0,fields:i(n).data,id:l.id,onValidateForm:h},null,8,["modelValue","fields","id"])):V("",!0)]),_:1})]),_:1}))}};export{B as default};
//# sourceMappingURL=ShiftRequestForm-W9MlCKrk.js.map
