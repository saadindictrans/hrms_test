{"version":3,"file":"attendance-B5rS8QWG.js","sources":["../../../../frontend/src/data/attendance.js"],"sourcesContent":["import { createListResource, createResource } from \"frappe-ui\"\nimport { employeeResource } from \"./employee\"\n\nimport dayjs from \"@/utils/dayjs\"\n\nexport const getDates = (shift) => {\n\tconst fromDate = dayjs(shift.from_date).format(\"D MMM\")\n\tconst toDate = shift.to_date ? dayjs(shift.to_date).format(\"D MMM\") : \"Ongoing\"\n\treturn fromDate == toDate ? fromDate : `${fromDate} - ${toDate}`\n}\n\nexport const getTotalDays = (shift) => {\n\tif (!shift.to_date) return null\n\tconst toDate = dayjs(shift.to_date)\n\tconst fromDate = dayjs(shift.from_date)\n\treturn toDate.diff(fromDate, \"d\") + 1\n}\n\nexport const getShiftDates = (shift) => {\n\tconst startDate = dayjs(shift.start_date).format(\"D MMM\")\n\tconst endDate = shift.end_date ? dayjs(shift.end_date).format(\"D MMM\") : \"Ongoing\"\n\treturn startDate == endDate ? startDate : `${startDate} - ${endDate}`\n}\n\nexport const getTotalShiftDays = (shift) => {\n\tif (!shift.end_date) return null\n\tconst end_date = dayjs(shift.end_date)\n\tconst start_date = dayjs(shift.start_date)\n\treturn end_date.diff(start_date, \"d\") + 1\n}\n\nexport const getShiftTiming = (shift) => {\n\treturn (\n\t\tshift.start_time.split(\":\").slice(0, 2).join(\":\") +\n\t\t\" - \" +\n\t\tshift.end_time.split(\":\").splice(0, 2).join(\":\")\n\t)\n}\n\nconst transformShiftRequests = (data) =>\n\tdata.map((request) => {\n\t\trequest.doctype = \"Shift Request\"\n\t\trequest.shift_dates = getDates(request)\n\t\trequest.total_shift_days = getTotalDays(request)\n\t\treturn request\n\t})\n\nexport const myAttendanceRequests = createListResource({\n\tdoctype: \"Attendance Request\",\n\tfields: [\n\t\t\"name\",\n\t\t\"reason\",\n\t\t\"from_date\",\n\t\t\"to_date\",\n\t\t\"include_holidays\",\n\t\t\"shift\",\n\t\t\"docstatus\",\n\t\t\"creation\",\n\t],\n\tfilters: {\n\t\temployee: employeeResource.data?.name,\n\t\tdocstatus: [\"!=\", 2],\n\t},\n\tpageLength: 10,\n\torderBy: \"creation desc\",\n\tauto: true,\n\tcache: \"hrms:attendance_requests\",\n\ttransform: (data) => {\n\t\treturn data.map((request) => {\n\t\t\trequest.doctype = \"Attendance Request\"\n\t\t\trequest.attendance_dates = getDates(request)\n\t\t\trequest.total_attendance_days = getTotalDays(request)\n\t\t\treturn request\n\t\t})\n\t},\n})\n\nexport const myShiftRequests = createResource({\n\turl: \"hrms.api.get_shift_requests\",\n\tparams: {\n\t\temployee: employeeResource.data.name,\n\t\tlimit: 10,\n\t},\n\tauto: true,\n\tcache: \"hrms:my_shift_requests\",\n\ttransform(data) {\n\t\treturn transformShiftRequests(data)\n\t},\n})\n\nexport const teamShiftRequests = createResource({\n\turl: \"hrms.api.get_shift_requests\",\n\tparams: {\n\t\temployee: employeeResource.data.name,\n\t\tapprover_id: employeeResource.data.user_id,\n\t\tfor_approval: 1,\n\t\tlimit: 10,\n\t},\n\tauto: true,\n\tcache: \"hrms:team_shift_requests\",\n\ttransform(data) {\n\t\treturn transformShiftRequests(data)\n\t},\n})\n"],"names":["getDates","shift","fromDate","dayjs","toDate","getTotalDays","getShiftDates","startDate","endDate","getTotalShiftDays","end_date","start_date","getShiftTiming","transformShiftRequests","data","request","myAttendanceRequests","createListResource","_a","employeeResource","myShiftRequests","createResource","teamShiftRequests"],"mappings":"mGAKY,MAACA,EAAYC,GAAU,CAClC,MAAMC,EAAWC,EAAMF,EAAM,SAAS,EAAE,OAAO,OAAO,EAChDG,EAASH,EAAM,QAAUE,EAAMF,EAAM,OAAO,EAAE,OAAO,OAAO,EAAI,UACtE,OAAOC,GAAYE,EAASF,EAAW,GAAGA,CAAQ,MAAME,CAAM,EAC/D,EAEaC,EAAgBJ,GAAU,CACtC,GAAI,CAACA,EAAM,QAAS,OAAO,KAC3B,MAAMG,EAASD,EAAMF,EAAM,OAAO,EAC5BC,EAAWC,EAAMF,EAAM,SAAS,EACtC,OAAOG,EAAO,KAAKF,EAAU,GAAG,EAAI,CACrC,EAEaI,EAAiBL,GAAU,CACvC,MAAMM,EAAYJ,EAAMF,EAAM,UAAU,EAAE,OAAO,OAAO,EAClDO,EAAUP,EAAM,SAAWE,EAAMF,EAAM,QAAQ,EAAE,OAAO,OAAO,EAAI,UACzE,OAAOM,GAAaC,EAAUD,EAAY,GAAGA,CAAS,MAAMC,CAAO,EACpE,EAEaC,EAAqBR,GAAU,CAC3C,GAAI,CAACA,EAAM,SAAU,OAAO,KAC5B,MAAMS,EAAWP,EAAMF,EAAM,QAAQ,EAC/BU,EAAaR,EAAMF,EAAM,UAAU,EACzC,OAAOS,EAAS,KAAKC,EAAY,GAAG,EAAI,CACzC,EAEaC,EAAkBX,GAE7BA,EAAM,WAAW,MAAM,GAAG,EAAE,MAAM,EAAG,CAAC,EAAE,KAAK,GAAG,EAChD,MACAA,EAAM,SAAS,MAAM,GAAG,EAAE,OAAO,EAAG,CAAC,EAAE,KAAK,GAAG,EAI3CY,EAA0BC,GAC/BA,EAAK,IAAKC,IACTA,EAAQ,QAAU,gBAClBA,EAAQ,YAAcf,EAASe,CAAO,EACtCA,EAAQ,iBAAmBV,EAAaU,CAAO,EACxCA,EACP,QAEU,MAACC,EAAuBC,EAAmB,CACtD,QAAS,qBACT,OAAQ,CACP,OACA,SACA,YACA,UACA,mBACA,QACA,YACA,UACA,EACD,QAAS,CACR,UAAUC,EAAAC,EAAiB,OAAjB,YAAAD,EAAuB,KACjC,UAAW,CAAC,KAAM,CAAC,CACnB,EACD,WAAY,GACZ,QAAS,gBACT,KAAM,GACN,MAAO,2BACP,UAAYJ,GACJA,EAAK,IAAKC,IAChBA,EAAQ,QAAU,qBAClBA,EAAQ,iBAAmBf,EAASe,CAAO,EAC3CA,EAAQ,sBAAwBV,EAAaU,CAAO,EAC7CA,EACP,CAEH,CAAC,EAEYK,EAAkBC,EAAe,CAC7C,IAAK,8BACL,OAAQ,CACP,SAAUF,EAAiB,KAAK,KAChC,MAAO,EACP,EACD,KAAM,GACN,MAAO,yBACP,UAAUL,EAAM,CACf,OAAOD,EAAuBC,CAAI,CAClC,CACF,CAAC,EAEYQ,EAAoBD,EAAe,CAC/C,IAAK,8BACL,OAAQ,CACP,SAAUF,EAAiB,KAAK,KAChC,YAAaA,EAAiB,KAAK,QACnC,aAAc,EACd,MAAO,EACP,EACD,KAAM,GACN,MAAO,2BACP,UAAUL,EAAM,CACf,OAAOD,EAAuBC,CAAI,CAClC,CACF,CAAC"}