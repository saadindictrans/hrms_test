import{a as x,a3 as b,c as M,w as V,e as $,a4 as C,A as v,n as w,i,f as j,j as o,q as n,k as d,t as k,v as r,a5 as N,l as _,a6 as D,a7 as L,F as T,I as A}from"./frappe-ui-qLvTFYQB.js";import F from"./BaseLayout-C3wPTlfn.js";import{_ as R}from"./index-CEKosOWR.js";import U from"./SalarySlipItem-BsbxQ7v3.js";import{f as q}from"./formatters-Ct4yxM4M.js";import"./notifications-W5tSfcNs.js";import"./ListItem-Cug_YXld.js";import"./EmployeeAvatar-C8o_82kt.js";const E={class:"flex flex-col items-center my-7 p-4"},I={class:"flex flex-col w-full bg-white rounded py-5 px-3.5 gap-5"},z={key:0,class:"flex flex-col w-full gap-1.5"},G={class:"text-gray-600 text-sm font-medium leading-5"},H={class:"text-gray-800 text-xl font-bold leading-6"},J={class:"flex flex-col items-center mt-5 mb-7 w-full"},K={key:0,class:"flex flex-col bg-white rounded mt-5 overflow-auto w-full"},le={__name:"Dashboard",setup(O){var y,g;let t=x({}),u=x({});const c=i("$employee"),f=i("$dayjs"),p=i("$socket"),S=b({doctype:"Payroll Period",fields:["name","start_date","end_date"],filters:{company:(y=c.data)==null?void 0:y.company},orderBy:"start_date desc",auto:!0,transform(e){return e.map(a=>(u.value[a.name]=a,{label:P(a),value:a.name}))},onSuccess:e=>{t.value=e[0]}}),s=b({doctype:"Salary Slip",fields:["name","start_date","end_date","currency","gross_pay","net_pay","year_to_date"],filters:{employee:(g=c.data)==null?void 0:g.name,docstatus:1},orderBy:"end_date desc"}),m=M(()=>{var e;return(e=s.data)==null?void 0:e[0]});function P(e){return`${f(e==null?void 0:e.start_date).format("MMM YYYY")} - ${f(e==null?void 0:e.end_date).format("MMM YYYY")}`}return V(()=>t.value,e=>{let a=u.value[e==null?void 0:e.value];s.filters.start_date=["between",[a==null?void 0:a.start_date,a==null?void 0:a.end_date]],s.reload()}),$(()=>{p.on("hrms:update_salary_slips",e=>{e.employee===c.data.name&&s.reload()})}),C(()=>{p.off("hrms:update_salary_slips")}),(e,a)=>{const Y=j("router-link");return o(),v(F,{pageTitle:e.__("Salary Slips")},{body:w(()=>{var h;return[n("div",E,[n("div",I,[m.value?(o(),d("div",z,[n("span",G,k(e.__("Year To Date")),1),n("span",H,k(r(q)(m.value.year_to_date,m.value.currency)),1)])):N("",!0),_(r(L),{label:e.__("Payroll Period"),class:"w-full",placeholder:e.__("Select Payroll Period"),modelValue:r(t),"onUpdate:modelValue":a[0]||(a[0]=l=>D(t)?t.value=l:t=l),options:r(S).data},null,8,["label","placeholder","modelValue","options"])]),n("div",J,[(h=r(s).data)!=null&&h.length?(o(),d("div",K,[(o(!0),d(T,null,A(r(s).data,l=>(o(),d("div",{class:"p-3.5 items-center justify-between border-b cursor-pointer",key:l.name},[_(Y,{to:{name:"SalarySlipDetailView",params:{id:l.name}}},{default:w(({navigate:B})=>[_(U,{doc:l,onClick:B},null,8,["doc","onClick"])]),_:2},1032,["to"])]))),128))])):(o(),v(R,{key:1,message:"No salary slips found"}))])])]}),_:1},8,["pageTitle"])}}};export{le as default};
//# sourceMappingURL=Dashboard-B4ZDvkJZ.js.map
